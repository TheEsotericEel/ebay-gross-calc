{
  "version": 3,
  "sources": ["../../src/calc/math.ts", "../../src/content/content.ts"],
  "sourcesContent": ["// src/calc/math.ts  (new)\r\nexport type Order = {\r\n  gross: number;      // buyer paid item price + tax + shipping collected (optional)\r\n  itemPrice?: number; // if you want fees based on item price only\r\n  shippingCost: number; // your label cost\r\n  cogs: number;\r\n  fees?: number;      // platform + processing; if omitted we compute approx\r\n  ads?: number;       // promoted listings spend\r\n  refunds?: number;   // refunds given\r\n};\r\n\r\nexport type Goals = {\r\n  weeklySalesGoal: number;     // $ target for week\r\n  listingGoalDaily?: number;   // $ listed per day target\r\n};\r\n\r\nexport type KPIs = {\r\n  units: number;\r\n  gross: number;\r\n  net: number;\r\n  asp: number;\r\n  marginPct: number;\r\n  fees: number;\r\n  ads: number;\r\n  shippingCost: number;\r\n  cogs: number;\r\n  refunds: number;\r\n  progressWeekly: number;      // 0..1 of gross vs weekly goal\r\n  pipelineListedToday: number; // current listedToday dollars\r\n  pipelineProgress: number;    // 0..1 listedToday vs listingGoalDaily\r\n};\r\n\r\n// crude fee model fallback if per\u2011order fees not supplied\r\nexport function estimateFees(order: Order, opts = { feeRate: 0.13, procRate: 0.029, procFixed: 0.30 }) {\r\n  const base = order.itemPrice ?? order.gross;\r\n  const marketplaceFee = base * opts.feeRate;\r\n  const processingFee = base * opts.procRate + opts.procFixed;\r\n  return marketplaceFee + processingFee;\r\n}\r\n\r\nexport function computeKPIs(orders: Order[], goals: Goals, listedToday = 0): KPIs {\r\n  let units = orders.length;\r\n  let gross = 0, fees = 0, ads = 0, shippingCost = 0, cogs = 0, refunds = 0;\r\n\r\n  for (const o of orders) {\r\n    gross += o.gross;\r\n    fees  += o.fees ?? estimateFees(o);\r\n    ads   += o.ads ?? 0;\r\n    shippingCost += o.shippingCost;\r\n    cogs  += o.cogs;\r\n    refunds += o.refunds ?? 0;\r\n  }\r\n  const net = gross - fees - ads - shippingCost - cogs - refunds;\r\n  const asp = units ? gross / units : 0;\r\n  const marginPct = gross ? net / gross : 0;\r\n\r\n  const progressWeekly = goals.weeklySalesGoal > 0 ? Math.min(1, gross / goals.weeklySalesGoal) : 0;\r\n  const pipelineProgress = goals.listingGoalDaily && goals.listingGoalDaily > 0\r\n    ? Math.min(1, listedToday / goals.listingGoalDaily)\r\n    : 0;\r\n\r\n  return {\r\n    units, gross, net, asp, marginPct,\r\n    fees, ads, shippingCost, cogs, refunds,\r\n    progressWeekly, pipelineListedToday: listedToday, pipelineProgress\r\n  };\r\n}\r\n", "\uFEFF// src/content/content.ts  (replace whole file)\r\n// Overlay UI with nested categories: Overview, Goals, Pipeline, Orders (manual)\r\nimport { computeKPIs, type Order } from \"../calc/math.js\";\r\n\r\n(() => {\r\n  if (document.getElementById(\"egc-root\")) return;\r\n\r\n  const host = document.createElement(\"div\");\r\n  host.id = \"egc-root\";\r\n  const shadow = host.attachShadow({ mode: \"open\" });\r\n\r\n  const style = document.createElement(\"style\");\r\n  style.textContent = `\r\n    :host, * { box-sizing: border-box }\r\n    .panel { position: fixed; bottom: 16px; right: 16px; width: 320px; max-height: 70vh;\r\n      background:#0f1115; color:#e6e6e6; border:1px solid #2a2f3a; border-radius:12px;\r\n      font:12px system-ui, -apple-system, Segoe UI, Roboto, sans-serif; box-shadow:0 8px 28px rgba(0,0,0,.35); overflow:auto; }\r\n    .hdr { display:flex; align-items:center; gap:8px; padding:10px 12px; border-bottom:1px solid #222; position:sticky; top:0; background:#0f1115 }\r\n    .dot { width:8px; height:8px; border-radius:50%; background:#4ade80 }\r\n    .title { font-weight:600; font-size:12px }\r\n    .row { display:flex; justify-content:space-between; align-items:center; padding:6px 0 }\r\n    .sec { padding:10px 12px }\r\n    .k { color:#9aa4b2 }\r\n    .v { color:#fff }\r\n    button, input[type=number] { font:12px inherit }\r\n    button { background:#1f2430; color:#e6e6e6; border:1px solid #2a2f3a; border-radius:6px; padding:5px 8px; cursor:pointer }\r\n    button:hover { background:#262c39 }\r\n    input[type=number]{ width:100px; background:#0b0d12; color:#e6e6e6; border:1px solid #2a2f3a; border-radius:6px; padding:4px 6px }\r\n    details { border:1px solid #1e2330; border-radius:8px; margin:8px 0; background:#0b0d12 }\r\n    summary { padding:8px 10px; cursor:pointer; color:#c9d1d9; user-select:none }\r\n    .content { padding:8px 10px; border-top:1px solid #1e2330 }\r\n    .grid { display:grid; grid-template-columns: 1fr auto; gap:6px 10px }\r\n    .subtle { color:#9aa4b2; font-size:11px }\r\n    .rowgap { display:flex; gap:6px; align-items:center }\r\n    .pill { padding:2px 6px; border-radius:999px; background:#1f2430; border:1px solid #2a2f3a }\r\n    .link { color:#60a5fa; text-decoration:underline; cursor:pointer }\r\n  `;\r\n\r\n  const wrap = document.createElement(\"div\");\r\n  wrap.className = \"panel\";\r\n  wrap.innerHTML = `\r\n    <div class=\"hdr\">\r\n      <div class=\"dot\" title=\"running\"></div>\r\n      <div class=\"title\">eBay Gross Calc</div>\r\n      <div class=\"pill\" id=\"statusPill\">manual</div>\r\n      <div style=\"margin-left:auto\" class=\"rowgap\">\r\n        <button id=\"openOptions\">Settings</button>\r\n        <button id=\"minBtn\" title=\"Collapse\">\u2013</button>\r\n      </div>\r\n    </div>\r\n    <div class=\"sec\" id=\"bodySec\">\r\n      <details open>\r\n        <summary>Overview</summary>\r\n        <div class=\"content\">\r\n          <div class=\"grid\">\r\n            <div class=\"k\">Units</div><div class=\"v\" id=\"k_units\">0</div>\r\n            <div class=\"k\">Gross</div><div class=\"v\" id=\"k_gross\">$0.00</div>\r\n            <div class=\"k\">Net</div><div class=\"v\" id=\"k_net\">$0.00</div>\r\n            <div class=\"k\">Margin</div><div class=\"v\" id=\"k_margin\">0%</div>\r\n            <div class=\"k\">ASP</div><div class=\"v\" id=\"k_asp\">$0.00</div>\r\n          </div>\r\n          <div class=\"subtle\" style=\"margin-top:6px\">Weekly progress: <span id=\"k_week\">%0</span></div>\r\n        </div>\r\n      </details>\r\n\r\n      <details>\r\n        <summary>Goals</summary>\r\n        <div class=\"content\">\r\n          <div class=\"grid\">\r\n            <div class=\"k\">Weekly sales goal</div><div class=\"v\" id=\"g_weekly\">$0</div>\r\n            <div class=\"k\">Daily listing goal</div><div class=\"v\" id=\"g_daily\">$0</div>\r\n          </div>\r\n          <div class=\"subtle\" style=\"margin-top:6px\"><span class=\"link\" id=\"goToSettings\">Edit in Settings</span></div>\r\n        </div>\r\n      </details>\r\n\r\n      <details>\r\n        <summary>Pipeline</summary>\r\n        <div class=\"content\">\r\n          <div class=\"grid\">\r\n            <div class=\"k\">Listed today</div>\r\n            <div class=\"rowgap\" style=\"justify-content:flex-end\">\r\n              <input id=\"listedToday\" type=\"number\" min=\"0\" step=\"1\" />\r\n              <button id=\"saveListed\">Save</button>\r\n            </div>\r\n            <div class=\"k\">Progress</div><div class=\"v\" id=\"k_pipe\">0%</div>\r\n          </div>\r\n        </div>\r\n      </details>\r\n\r\n      <details>\r\n        <summary>Orders (manual)</summary>\r\n        <div class=\"content\">\r\n          <div class=\"subtle\">Add via Settings \u2192 Manual Orders. Quick add here:</div>\r\n          <div class=\"rowgap\" style=\"margin-top:6px; flex-wrap:wrap\">\r\n            <input id=\"q_gross\" type=\"number\" placeholder=\"Gross $\" step=\"0.01\" />\r\n            <input id=\"q_ship\"  type=\"number\" placeholder=\"Ship $\" step=\"0.01\" />\r\n            <input id=\"q_cogs\"  type=\"number\" placeholder=\"COGS $\" step=\"0.01\" />\r\n            <button id=\"q_add\">Add</button>\r\n            <button id=\"q_clear\" title=\"Clear all orders\">Clear</button>\r\n          </div>\r\n          <div class=\"subtle\" style=\"margin-top:6px\"><span id=\"ordersCount\">0</span> orders in memory</div>\r\n        </div>\r\n      </details>\r\n    </div>\r\n  `;\r\n\r\n  shadow.append(style, wrap);\r\n\r\n  // State helpers\r\n  async function getState() {\r\n    const keys = [\"weeklyGoal\", \"listingGoalDaily\", \"listedToday\", \"orders\"] as const;\r\n    const st = await chrome.storage.local.get(keys as unknown as string[]);\r\n    return {\r\n      weeklyGoal: Number(st.weeklyGoal ?? 0),\r\n      listingGoalDaily: Number(st.listingGoalDaily ?? 0),\r\n      listedToday: Number(st.listedToday ?? 0),\r\n      orders: (st.orders ?? []) as Order[]\r\n    };\r\n  }\r\n  const $ = (id: string) => shadow.getElementById(id)!;\r\n\r\n  async function render() {\r\n    const { weeklyGoal, listingGoalDaily, listedToday, orders } = await getState();\r\n    const k = computeKPIs(orders, { weeklySalesGoal: weeklyGoal, listingGoalDaily }, listedToday);\r\n\r\n    // KPIs\r\n    $(\"k_units\").textContent = String(k.units);\r\n    $(\"k_gross\").textContent = `$${k.gross.toFixed(2)}`;\r\n    $(\"k_net\").textContent = `$${k.net.toFixed(2)}`;\r\n    $(\"k_margin\").textContent = `${(k.marginPct * 100).toFixed(0)}%`;\r\n    $(\"k_asp\").textContent = `$${k.asp.toFixed(2)}`;\r\n    $(\"k_week\").textContent = `${(k.progressWeekly * 100).toFixed(0)}%`;\r\n\r\n    // Goals\r\n    $(\"g_weekly\").textContent = `$${weeklyGoal}`;\r\n    $(\"g_daily\").textContent = `$${listingGoalDaily}`;\r\n\r\n    // Pipeline\r\n    ( $(\"listedToday\") as HTMLInputElement ).value = String(listedToday);\r\n    $(\"k_pipe\").textContent = listingGoalDaily > 0 ? `${Math.min(100, Math.round((listedToday / listingGoalDaily) * 100))}%` : \"0%\";\r\n\r\n    // Orders\r\n    $(\"ordersCount\").textContent = String(orders.length);\r\n  }\r\n\r\n  // Events\r\n  $(\"openOptions\").addEventListener(\"click\", () => chrome.runtime.openOptionsPage());\r\n  $(\"goToSettings\").addEventListener(\"click\", () => chrome.runtime.openOptionsPage());\r\n\r\n  $(\"minBtn\").addEventListener(\"click\", () => {\r\n    const body = $(\"bodySec\");\r\n    const btn = $(\"minBtn\") as HTMLButtonElement;\r\n    const hidden = body.hasAttribute(\"hidden\");\r\n    if (hidden) { body.removeAttribute(\"hidden\"); btn.textContent = \"\u2013\"; }\r\n    else { body.setAttribute(\"hidden\",\"\"); btn.textContent = \"+\"; }\r\n  });\r\n\r\n  $(\"saveListed\").addEventListener(\"click\", async () => {\r\n    const v = Number(( $(\"listedToday\") as HTMLInputElement ).value) || 0;\r\n    await chrome.storage.local.set({ listedToday: v });\r\n  });\r\n\r\n  $(\"q_add\").addEventListener(\"click\", async () => {\r\n    const gross = Number(( $(\"q_gross\") as HTMLInputElement ).value) || 0;\r\n    const shippingCost = Number(( $(\"q_ship\") as HTMLInputElement ).value) || 0;\r\n    const cogs = Number(( $(\"q_cogs\") as HTMLInputElement ).value) || 0;\r\n    const st = await getState();\r\n    st.orders.push({ gross, shippingCost, cogs });\r\n    await chrome.storage.local.set({ orders: st.orders });\r\n    ( $(\"q_gross\") as HTMLInputElement ).value = \"\";\r\n    ( $(\"q_ship\") as HTMLInputElement ).value = \"\";\r\n    ( $(\"q_cogs\") as HTMLInputElement ).value = \"\";\r\n  });\r\n\r\n  $(\"q_clear\").addEventListener(\"click\", async () => {\r\n    await chrome.storage.local.set({ orders: [] });\r\n  });\r\n\r\n  chrome.storage.onChanged.addListener((_changes, _area) => render());\r\n  render();\r\n})();\r\n"],
  "mappings": "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",
  "names": []
}
